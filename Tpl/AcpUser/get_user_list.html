{extends file="../acp.html"}

{block name="title"}{$head_title}{/block}
{block name="content"}
<div class="t-a-wait-con">
    <div class="tablesWrap"> 
    	{if $opt == 'user'}
    	<div class="t-rank-tit" style="margin:10px;"><a href="/AcpUser/add_user" class="btn btn-blue"><i class="gicon-plus white"></i>添加用户</a></div>
    	{else}
    	<div class="t-rank-tit" style="margin:10px;"><a href="/AcpUser/add_agent" class="btn btn-blue"><i class="gicon-plus white"></i>添加代理商</a></div>
    	{/if}
    	<div class="tables-searchbox">
            <div class="t-a-wait-top">
                <form action="" method="post" id="rank_waiting">
                    <div class="t-a-wait-top-li"><span>ID：</span><input type="text" placeholder="" value="{$id}" class="mini" name="id"> </div>
                    {if $opt == 'user'}
                <div class="t-a-wait-top-li"><span>昵称：</span><input type="text" placeholder="" value="{$nickname}" class="mini" name="nickname"> </div>
                <!--<div class="t-a-wait-top-li"><span>姓名：</span><input type="text" placeholder="" value="{$alipay_account_name}" class="mini" name="alipay_account_name"> </div>-->

                <div class="t-a-wait-top-li">
                <span>用户等级：</span>
                <select class="small" name="level_id">
                    <option value="0" >--请选择--</option>
                    {section name=row loop=$level_list}
                    <option value="{$level_list[row].level_id}" {if $level_list[row].level_id == $level_id}selected{/if} >{$level_list[row].level_name}</option>
                    {/section}
                </select>
                </div>

                {/if}
                <div class="t-a-wait-top-li"><span>姓名：</span><input type="text" placeholder="" value="{$realname}" class="small" name="realname"> </div>
                <div class="t-a-wait-top-li"><span>手机号：</span><input type="text" placeholder="" value="{$mobile}" class="small" name="mobile"> </div>
                <!--div class="t-a-wait-top-li"><span>QQ：</span><input type="text" placeholder="" value="{$qq}" class="mini" name="qq"> </div-->
                <!--div class="t-a-wait-top-li"><span>邮箱：</span><input type="text" placeholder="" value="{$email}" class="mini" name="email"> </div-->
                    <!--
                <div class="t-a-wait-top-li">
                <select class="small" name="big_area_id">
                    <option value="0" >大区</option>
                    {section name=row loop=$big_area_list}
                    <option value="{$big_area_list[row].big_area_id}" {if $big_area_list[row].big_area_id == $big_area_id}selected{/if} >{$big_area_list[row].area_name}</option>
                    {/section}
                </select>
                </div>
                    -->
                <div class="t-a-wait-top-li" style="width:400px;">
                    <div class="formitems inline">  
                        <label class="fi-name" style="width:70px; font-weight:normal;">注册时间：</label>  
                        <div class="form-controls" style="margin-left:80px;">  
				            <input type="text" style="width:120px;" autocomplete="off" class="Wdate" name="start_time" value="{if $start_time}{date('Y-m-d',$start_time)}{/if}" onclick="WdatePicker({ dateFmt:'yyyy-MM-dd'})">  

                            <span class="fi-text">-</span>  
                            
                            <input type="text" style="width:120px;" autocomplete="off" class="Wdate" name="end_time" value="{if $end_time}{date('Y-m-d',$end_time)}{/if}" onclick="WdatePicker({ dateFmt:'yyyy-MM-dd'})">  
                        </div>  
                    </div> 
                </div>
                    {if $head_title == '当天游戏用户列表'}
                    <div class="t-a-wait-top-li" style="width:400px;">
                        <div class="formitems inline">
                            <label class="fi-name" style="width:70px; font-weight:normal;">游玩时间筛选：</label>
                            <div class="form-controls" style="margin-left:80px;">
                                <input type="text" style="width:120px;" autocomplete="off" class="Wdate" name="bet_start_time" value="{if $bet_start_time}{date('Y-m-d',$bet_start_time)}{/if}" onclick="WdatePicker({ dateFmt:'yyyy-MM-dd'})">

                                <span class="fi-text">-</span>

                                <input type="text" style="width:120px;" autocomplete="off" class="Wdate" name="bet_end_time" value="{if $bet_end_time}{date('Y-m-d',$bet_end_time)}{/if}" onclick="WdatePicker({ dateFmt:'yyyy-MM-dd'})">
                            </div>
                        </div>
                    </div>
                    {/if}
                <div class="t-a-wait-top-li" style=""><input type="hidden" name="submit" value="search" /><button class="btn"><i class="gicon-search"></i>搜索</button> </div>
              </form>
            </div>        
        </div> 
        <table class="wxtables">  
            <colgroup>
                <!--<col width="5%"> -->
                <!--<col width="5%">-->
                <!--<col width="5%">  -->
                <!--<col width="5%">-->
                <!--<col width="5%">-->
                <!--<col width="5%">-->
                <!--<col width="5%"> -->


                <!--<col width="10%">  -->
                <!--<col width="10%">-->
                <col width="20%">
                <col width="20%">
                {if $new  == 1}
                <col width="20%">
                <col width="20%">
                {/if}
                {if $opt == 'agent'}
                <col width="10%">
                <col width="10%">
                <col width="10%">
                {/if}
                {if $new != 1}
                <col width="50%">
                {/if}
            </colgroup>
            <thead>  
                <tr>  
                    <!--<td>选择</td>-->
                    {if $opt == 'user'}  
                    <td>ID</td>
                    <td>昵称</td>  
                    <!--<td>姓名</td>  -->
                    <!--<td>用户等级</td>-->
                    <!--<td>手机</td>-->
                    <!--<td>邮箱</td>-->
                    <!--<td>QQ</td>-->
                    {/if}
                    {if $new  == 1}
                    <td>当日输赢</td>
                    <td>余额</td>
                    {/if}
                    {if $opt == 'agent'}
                    <td>ID</td>
                    <td>代理商姓名</td>  
                    <td>代理商介绍</td>
                    <td>点卡介绍</td>
                    <td>是否展示</td>
                    <!--<td>邮箱</td>-->
                    <!--<td>QQ</td>-->
                    {/if}
                    <!-- <td>所在地区</td> -->
                    <!--<td>注册时间</td>-->
                    {if $new != 1}
                    <td>操作</td>
                    {/if}
                </tr>  
            </thead>  
            <tbody>
				{foreach from=$user_list item=user}
                <tr>  
                    <!--<td><input type="checkbox" class="checkbox" value='{$user.user_id}' name="a[]"></td> -->
                    {if $opt == 'user'} 
                    <td><a href="/AcpUser/user_detail/user_id/{$user.user_id}" title="查看用户详情"><span style="color: blue">{$user.invite_id}</span></a></td>
                    <td>{if $user.nickname}{$user.nickname}{else}--{/if}</td>
                    <!--<td>{if $user.alipay_account_name}{$user.alipay_account_name}{else}&#45;&#45;{/if}</td>-->
                    <!--<td>{if $user.level_name}{$user.level_name}{else}&#45;&#45;{/if}</td>-->
                    <!--<td>{if $user.mobile}{$user.mobile}{else}&#45;&#45;{/if}</td>-->
                    <!--<td><span>{if $user.email}{$user.email}{else}&#45;&#45;{/if}</span></td>  -->
                    <!--<td><span>{if $user.qq}{$user.qq}{else}&#45;&#45;{/if}</span></td>  -->
                    {/if}
                    {if $new  == 1}
                    <td>{if $user.bet_total}{$user.bet_total}{else}0.00{/if}</td>
                    <td>{$user.left_money}</td>
                    {/if}
                    {if $opt == 'agent'}
                    <td><a href="/AcpUser/user_detail/user_id/{$user.user_id}" title="查看用户详情"><span style="color: blue">{$user.id}</span></a></td>
                    <td>{if $user.realname}{$user.realname}{else}--{/if}</td>  
                    <td>{if $user.introduce}{$user.introduce}{else}--{/if}</td>
                    <td>{if $user.game_name}{$user.game_name}{else}--{/if}</td>
                    <td>{if $user.is_index == 1}是{else}否{/if}</td>
                    <!--<td>{if $user.mobile}{$user.mobile}{else}&#45;&#45;{/if}</td>-->
                    <!--<td><span>{if $user.email}{$user.email}{else}&#45;&#45;{/if}</span></td>  -->
                    <!--<td><span>{if $user.qq}{$user.qq}{else}&#45;&#45;{/if}</span></td> -->
                    {/if}
                    <!-- <td>{$user.area_string}</td> -->
                    <!--<td>{$user.reg_time|date_format:"%Y-%m-%d %H:%M:%S"}</td>-->
                    {if $new != 1}
                    <td>  
                        {if $user.role_type == 3}
                            <a href="/AcpUser/edit_user/user_id/{$user.user_id}" class="btn" title="修改用户信息">修改</a> 
<!--                            <a href="javascript:;" class="btn" onclick="set_to_agent({$user.user_id})" title="设置为代理商">设置为代理商</a> -->
                            <a href="/AcpGame/get_bet_log/user_id/{$user.user_id}" class="btn" title="查看游戏记录">查看游戏记录</a>
                        {/if}
                        {if $user.is_extend_user== 1}
                        <a href="/AcpUser/extend_user/user_id/{$user.user_id}" class="btn" title="查看推广列表">查看推广列表</a>   
                        {/if}
						{if $user.is_enable == 1}
							<a href="javascript:;" class="btn" onclick="set_is_enable({$user.user_id}, 2)" title="禁用该用户">禁用</a>   
						{elseif $user.is_enable == 2}
							<a href="javascript:;" class="btn" onclick="set_is_enable({$user.user_id}, 1)" title="激活该用户">激活</a>   
						{/if}
						{if $opt == 'user'}
						<!-- <a href="/AcpUser/integral_detail/user_id/{$user.user_id}"  class="btn" title="查看积分明细">查看积分明细</a> -->
						<a href="/AcpFinance/get_account_log/user_id/{$user.user_id}"  class="btn" title="查看金豆变动明细">金豆变动明细</a>
						{else}
						<a href="/AcpUser/edit_agent_info/user_id/{$user.user_id}" class="btn" title="修改代理商信息">修改</a> 
						 <a href="javascript:;" class="btn j_form" title="调整余额" data-id="{$user.user_id}" >调整余额</a>
						<a href="/AcpFinance/get_agent_account_log/user_id/{$user.user_id}"  class="btn" title="余额变动明细">余额变动明细</a>
						{/if}
                        <!-- <a href="javascript:;" onclick="delUser({$user.user_id}, this);" class="btn" title="删除"><i class="gicon-trash black"></i>删除</a>     -->
                        <!--
							<a href="javascript:;" class="btn" onclick="general_code({$user.user_id})" title="生成二维码链接">二维码链接</a> 
							<a href="javascript:;" onclick="send_freight_coupon({$user.user_id});" class="btn" title="发放优惠券">发放优惠券</a>    --> 
                        <a href="/AcpUser/user_detail/user_id/{$user.user_id}" class="btn" title="查看用户详情">详情</a>   
						
                        
                    </td>
                    {/if}
                </tr>
                {foreachelse}
					<tr><td colspan="11">没有符合条件的用户</td></tr>
                {/foreach}
            </tbody>  
        </table>  
        <!-- end wxtables -->  
        <div class="tables-btmctrl clearfix">  
            <div class="fl">  
				<a href="javascript:;" class="btn btn-blue" onclick="Select()">全选</a>  
				<a href="javascript:;" class="btn btn-blue" onclick="Cancel()">取消</a>  
                <a href="javascript:void(0);" class="btn btn-blue" onclick="batch_set_is_enable(2)">批量禁用</a> 
                <a href="javascript:void(0);" class="btn btn-blue" onclick="batch_set_is_enable(1)">批量激活</a> 
                <!-- {if $opt == 'user'} <a href="javascript:void(0);" class="btn btn-blue" onclick="batch_send_freight_coupon()">批量发放优惠券</a> {/if}
                <a href="javascript:;" class="btn btn-blue" onclick="copy_link()">个人中心链接</a> -->
            </div>
            <div class="fr">  
                <div class="paginate">  
                    {if $show}
                    {$show}
                    {else}
                    人数:{$count}
                    {/if}
                </div>  
                <!-- end paginate -->  
            </div>  
        </div>  
        <!-- end tables-btmctrl -->  
    </div>  
    <!-- end tablesWrap --> 
</div>
{/block} 

{block name="js"}
<script src="/Public/Plugins/My97DatePicker/WdatePicker.js?version={$version}"></script>
<script>
    var url = '{$url}';
//全选
function Select(){
	var sel=document.getElementsByName("a[]");
	for(var i=0;i<sel.length;i++){
		sel[i].checked=true;
	}
}
//取消全选
function Cancel(){
	var sel=document.getElementsByName("a[]");
	for(var i=0;i<sel.length;i++){
		sel[i].checked=false;
	}
}

{literal} 
$(function() {

	var html='<form id="pop_demo">                                                                '+
			'<div class="formitems inline">                                                       '+
			'	<label class="fi-name"><span class="colorRed">*</span>变动金额(RMB)：</label>          '+
			'	<div class="form-controls">                                                       '+
			'		<input type="text" id="amount" name="amount" onkeyup="this.value=this.value.replace(/[^\\d]/g,\'\') " onafterpaste="this.value=this.value.replace(/[^\\d]/g,\'\') ">                                 '+
			'		<span class="fi-help-text" id="amount_ts">10000</span>       '+
			'	</div>                                                                            '+
			'</div>                                                                               '+
			'<div class="formitems inline">                                                       '+
			'	<label class="fi-name"><span class="colorRed"></span>选择变动类型：</label>      '+
			'	<div class="form-controls">                                                       '+
			'		<div class="radio-group">                                                     '+
			'			<label><input type="radio" name="amount_type" value="0" checked>加款</label>  '+
			'			<label><input type="radio" name="amount_type" value="1">减款</label>          '+
			'		</div>                                                                        '+
			'		<span class="fi-help-text"></span>                                            '+
			'	</div>                                                                            '+
			'</div>                                                                               '+
			'<div class="formitems inline">                                                       '+
			'	<label class="fi-name"><span class="colorRed"></span>操作备注：</label>           '+
			'	<div class="form-controls">                                                       '+
			'		<textarea name="remark" id="remark"></textarea>                               '+
			'		<span class="fi-help-text">一般在200字以内</span>                             '+
			'	</div>                                                                            '+
			'</div>																			      '+
			'</form>                                                                              ';
			
	$(".j_form").click(function(){
		var user_id = $(this).data('id');
		$.jPops.custom({
			title:"调整用户余额",
			content:html,
			callback:function(r){
				acp.popFormStatus=false;//弹窗表单验证状态
				if(r){
					$.validator.setDefaults({
						submitHandler: function() {
							acp.popFormStatus=true;//设置弹窗表单验证状态为通过
							var amount=$("#jpops #amount").val();
							var remark=$("#jpops #remark").val();
							var amount_type=$("#jpops").find("input[name='amount_type']:checked").val();
						
							$.ajax({
								url : '/AcpFinance/edit_agent_account', 
								type : 'POST', 
								dataType : 'JSON',
								timeout : 1000,
								data : {action : "set",user_id : user_id,amount_type : amount_type,amount : amount, remark : remark},
								error : function() {
									$.jPops.message({title:"操作提示",content: "操作失败请重试",timing:3000});
								},
								success : function(result) {
									if(result.code == 200)
									{
										$.jPops.message({title:"操作提示",content: result.msg,timing:3000});
										//刷新页面
										setTimeout(function(){window.location.reload() },2000);
									}
									else
									{
										$.jPops.message({title:"操作提示",content: result.msg,timing:3000});
									}
								}
							});
							
						}
					});

					//表单验证规则
					$("#pop_demo").validate({
						rules: {
							amount: {required: true}
						},
						// messages: {
						// 	amount: {required: "请输入变动金额", check_float: "格式如: 99.00 或 99.99"}
						// },
						errorPlacement: acp.form_ShowError,//显示出错信息(这段代码必须加)
						success:acp.form_HideError//验证成功隐藏错误信息(这段代码必须加)
					});

					//模拟提交表单
					$("#pop_demo").submit();

					return acp.popFormStatus;//通过表单验证状态确定是否关闭窗口
				}
				else{//点击取消按钮执行的事件
					return true;
				}
			}
			
		});
	})
 });
function set_is_enable(id, is_enable)
{
	opt = (is_enable == 1) ? '激活' : '禁用';
	$.jPops.confirm(
	{  
		 title:"提示",  
		 content:"您确定要执行该操作吗？",  
		 okBtnTxt:"确定",  
		 cancelBtnTxt:"取消",  
		 callback:function(r)
		 {  
			 if(r)
			 {
				 $.post('/AcpUserAjax/set_user_is_enable', {"user_id":id, "is_enable":is_enable}, function(data, textStatus) 
				 {
					if (data == 'success')
					{
						alert('恭喜您，' + opt + '成功！');
						location.reload();
					}
					else
					{
						alert('对不起，' + opt + '失败');
					}
				});
			 }  
			 return true;  
		 }
	 });  	
}
function set_to_agent(id)
{
	$.jPops.confirm(
	{  
		 title:"提示",  
		 content:"您确定要执行该操作吗？",  
		 okBtnTxt:"确定",  
		 cancelBtnTxt:"取消",  
		 callback:function(r)
		 {  
			 if(r)
			 {
				 $.post('/AcpUserAjax/set_to_agent', {"user_id":id}, function(data, textStatus) 
				 {
					if (data == 'success')
					{
						alert('恭喜您，设置成功！');
						location.reload();
					}
					else
					{
						alert('对不起，设置失败');
					}
				});
			 }  
			 return true;  
		 }
	 });  	
}

function batch_set_is_enable(is_enable)
{
	opt = (is_enable == 1) ? '激活' : '禁用';
	$.jPops.confirm(
	{  
		 title:"提示",  
		 content:"您确定要执行这些操作吗？",  
		 okBtnTxt:"确定",  
		 cancelBtnTxt:"取消",  
		 callback:function(r)
		 {  
			 if(r)
			 {
				 var ids = '';
				 var count = 0;
				 $('input[name="a[]"]:checked').each(function(){
					 count ++;
					 ids += $(this).val() + ',';
				 });

				 if (!count)
				 {
					 alert('对不起，请选择至少一项进行操作！');
					 return;
				 }

				 ids = ids.substr(0, ids.length - 1);

				 $.post('/AcpUserAjax/batch_set_user_is_enable', {"user_ids":ids, "is_enable":is_enable}, function(data, textStatus) 
				 {
					if (data == 'success')
					{
						alert('恭喜您，' + opt + '成功！');
						location.reload();
					}
					else
					{
						alert('对不起，' + opt + '失败');
					}
				});
			 }  
			 return true;  
		 }
	 });
}

function send_freight_coupon(user_id)
{
	var html='';

	var html='<form id="deliver_form">' + 
			'<div class="formitems inline">'+
				'<label class="fi-name"><span class="colorRed">*</span>优惠券名称：</label>'+ 
				'<div class="form-controls">'+
					'<input name="freight_name" id="freight_name"><span class="fi-help-text"> </span>'+
				'</div>' + 
			'</div>'+
			'<div class="formitems inline">'+
            '<label class="fi-name"><span class="colorRed">*</span>优惠券使用条件( > 元)：</label>'+ 
				'<div class="form-controls">'+
					'<input name="price_limit" id="price_limit"><span class="fi-help-text"> </span>'+
				'</div>' + 
			'</div>'+
			'<div class="formitems inline">'+
				'<label class="fi-name"><span class="colorRed">*</span>优惠券面额：</label>'+ 
				'<div class="form-controls">'+
					'<input name="freight_num" id="freight_num"><span class="fi-help-text"> </span>'+
				'</div>' + 
			'</div>'+
			'<div class="formitems inline">'+
				'<label class="fi-name"><span class="colorRed">*</span>有效天数：</label>'+ 
				'<div class="form-controls">'+
					'<input name="valid_day_num" id="valid_day_num"><span class="fi-help-text"> </span>'+
				'</div>' + 
			'</div>'+
		'</form>';
	
	$.jPops.custom({
		title:"发放优惠券",  
		content:html,
		okBtnTxt:"确定",  
		cancelBtnTxt:"取消",  
		callback:function(r)
		{
			if(r)
			{
			    var freight_name  = $('#freight_name').val();
				var freight_num   = $('#freight_num').val();
				var valid_day_num = $('#valid_day_num').val();
				var price_limit   = $('#price_limit').val();

				$.validator.setDefaults(
				{
					//表单验证通过后的处理，异步提交表单
					submitHandler: function()
					{
						$.post('/AcpPromo/dispatch_coupon',{"user_id":user_id,"num":freight_num,"valid_day_num":valid_day_num, "coupon_name":freight_name, "price_limit":price_limit},function(data)
						{
							if (data == 'success')
							{
								alert('恭喜您，操作成功');
							}
							else
							{
								alert('对不起，操作失败');
							}
						})
						acp.batchDeliverFormStatus = true;
					}
				});
			
				//表单验证规则
				$("#deliver_form").validate(
				{
					rules: 
					{
						freight_num: 
						{
							required: true,
							digits: true
						},
						valid_day_num: 
						{
							required: true,
							digits: true
						},
					},
					messages: 
					{
						freight_num: 
						{
							required: "对不起，请填写面额",
							digits: "面额请填写数字!"
						},
						valid_day_num: 
						{
							required: "对不起，请填写有效天数",
							digits: "有效天数请填写数字!"
						},
					},
					errorPlacement: acp.form_ShowError,//显示出错信息(这段代码必须加)
					success:acp.form_HideError//验证成功隐藏错误信息(这段代码必须加)
				});

				//模拟提交表单
				$("#deliver_form").submit();
				return acp.batchDeliverFormStatus;
			}
			else
			{
				return true;  
			}
		}
	});
}

function batch_send_freight_coupon()
{
	var html='';

	var user_ids = '';
	var count = 0;
	$('input[name="a[]"]:checked').each(function()
	{
		count ++;
		user_ids += $(this).val() + ',';
	});
	if (!count)
	{
		alert('对不起，请选择至少一个用户进行发放');
		return;
	}

	var user_ids = user_ids.substr(0, user_ids.length - 1);
	var html='<form id="batch_deliver_form">' + 
			'<div class="formitems inline">'+
				'<label class="fi-name"><span class="colorRed">*</span>优惠券名称：</label>'+ 
				'<div class="form-controls">'+
					'<input name="freight_name" id="freight_name"><span class="fi-help-text"> </span>'+
				'</div>' + 
			'</div>'+
			'<div class="formitems inline">'+
            '<label class="fi-name"><span class="colorRed">*</span>优惠券使用条件( > 元)：</label>'+ 
				'<div class="form-controls">'+
					'<input name="price_limit" id="price_limit"><span class="fi-help-text"> </span>'+
				'</div>' + 
			'</div>'+
			'<div class="formitems inline">'+
				'<label class="fi-name"><span class="colorRed">*</span>优惠券面额：</label>'+ 
				'<div class="form-controls">'+
					'<input name="freight_num" id="freight_num"><span class="fi-help-text"> </span>'+
				'</div>' + 
			'</div>'+
			'<div class="formitems inline">'+
				'<label class="fi-name"><span class="colorRed">*</span>有效天数：</label>'+ 
				'<div class="form-controls">'+
					'<input name="valid_day_num" id="valid_day_num"><span class="fi-help-text"> </span>'+
				'</div>' + 
			'</div>'+
		'</form>';
	
	$.jPops.custom({
		title:"批量发放镖金优惠券",  
		content:html,
		okBtnTxt:"确定",  
		cancelBtnTxt:"取消",  
		callback:function(r)
		{
			if(r)
			{
			    var freight_name  = $('#freight_name').val();
				var freight_num   = $('#freight_num').val();
				var valid_day_num = $('#valid_day_num').val();
				var price_limit   = $('#price_limit').val();

				$.validator.setDefaults(
				{
					//表单验证通过后的处理，异步提交表单
					submitHandler: function()
					{
						$.post('/AcpPromo/batch_dispatch_coupon',{"user_ids":user_ids,"freight_num":freight_num,"valid_day_num":valid_day_num, "coupon_name":freight_name, "price_limit":price_limit},function(data)
						{
							if (data == 'success')
							{
								alert('恭喜您，操作成功');
							}
							else
							{
								alert('对不起，操作失败');
							}
						})
						acp.batchDeliverFormStatus = true;
					}
				});
			
				//表单验证规则
				$("#batch_deliver_form").validate(
				{
					rules: 
					{
						freight_num: 
						{
							required: true,
							digits: true
						},
						valid_day_num: 
						{
							required: true,
							digits: true
						},
					},
					messages: 
					{
						freight_num: 
						{
							required: "对不起，请填写面额",
							digits: "面额请填写数字!"
						},
						valid_day_num: 
						{
							required: "对不起，请填写有效天数",
							digits: "有效天数请填写数字!"
						},
					},
					errorPlacement: acp.form_ShowError,//显示出错信息(这段代码必须加)
					success:acp.form_HideError//验证成功隐藏错误信息(这段代码必须加)
				});

				//模拟提交表单
				$("#batch_deliver_form").submit();
				return acp.batchDeliverFormStatus;
			}
			else
			{
				return true;  
			}
		}
	});
}

function delUser(_id, _this){
	$.jPops.confirm({
		title:"提示",
		content:'您确定要删除这条数据吗？',
		okBtnTxt:"确定",
		cancelBtnTxt:"取消",
		callback:function(r){
			if(r){
				$.ajax({
					url: '/AcpUser/ajax_del_user',
					data: {id: _id},
					success: function(data){
                        var msg = '';
						if(data == 'success'){
                            msg ="删除成功";
                        } else {
                            msg ="删除失败";
                        }
                        $.jPops.alert({
                            title:"提示",
                            content: msg,
                            okBtnTxt:"确定",
                            callback:function(){
                                location.href="/AcpUser/get_all_user_list?r=" + Math.random();
                                return true;
                            }
                        });
					}
				});
			}
			return true;
		}
	});
}

function general_code(id)
{
    if (!id) {
        alert('出错啦');
    }
    var url_link = url + '?register_p=' + id;
    $.jPops.custom({
		title:"二维码链接地址",  
		content:url_link,
		okBtnTxt:"确定",  
        cancelBtnTxt:"取消",  
        callback:function(r)
        {
            return true;
        } 
    });

}


    //复制链接
function copy_link()
{
    var link = 'http://' + document.domain + '/FrontUser/personal_center';
    $.jPops.custom({
        title:"请复制链接",  
        content:'<div>个人中心链接：' + link + '</div>',
        okBtnTxt:"复制",  
        cancelBtnTxt:"关闭",  
        callback:function(r)
        {
            if(r)
            {
                text = link;
                copy_text('jpops-btn-ok');
            }
            else
            {
                return true;  
            }
        }
    });
}
function copy_text(id)
    {
        var clipboard = new Clipboard('#' + id, {
            text: function() {
                return text;
            }
        });

        clipboard.on('success', function(e) {
            console.log(e);
            alert('复制成功');
        });

        clipboard.on('error', function(e) {
            console.log(e);
            alert('复制失败，请手动复制');
        });
    }
</script>
{/literal} 
{/block} 

{block name="css"}
<link rel="stylesheet" href="/Public/Css/acp/AcpUser/audit_waiting.css" type="text/css" />
{/block}
